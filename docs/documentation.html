<!DOCTYPE html>
<html lang="fr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Documentation Fonctionnelle - Ezio</title>
    <style>
        :root {
            --primary: #2563eb;
            --bg-body: #f8fafc;
            --bg-content: #ffffff;
            --text-main: #1e293b;
            --text-muted: #64748b;
            --border: #e2e8f0;
            --sidebar-width: 300px;
        }

        /* Dark Mode support system preference */
        @media (prefers-color-scheme: dark) {
            :root {
                --bg-body: #0f172a;
                --bg-content: #1e293b;
                --text-main: #f1f5f9;
                --text-muted: #94a3b8;
                --border: #334155;
            }
        }

        body {
            font-family: 'Segoe UI', system-ui, sans-serif;
            background-color: var(--bg-body);
            color: var(--text-main);
            margin: 0;
            display: flex;
            height: 100vh;
            overflow: hidden;
            line-height: 1.6;
        }

        /* Layout */
        .container {
            display: flex;
            width: 100%;
            max-width: 1400px;
            margin: 0 auto;
            height: 100%;
        }

        /* Sidebar Navigation (Left) */
        .nav-sidebar {
            width: var(--sidebar-width);
            background-color: #1e293b;
            /* Dark background */
            border-right: 1px solid var(--border);
            padding: 2rem;
            overflow-y: auto;
            order: 1;
            flex-shrink: 0;
            color: #f1f5f9;
            /* White/Light text */
        }

        .nav-sidebar h3 {
            font-size: 0.9rem;
            text-transform: uppercase;
            color: #94a3b8;
            /* Muted light text */
            margin-top: 0;
            margin-bottom: 1rem;
        }

        .nav-sidebar ul {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .nav-sidebar li {
            margin-bottom: 0.5rem;
        }

        .nav-sidebar a {
            text-decoration: none;
            color: #f1f5f9;
            /* White text */
            font-size: 0.95rem;
            display: block;
            padding: 0.25rem 0;
            transition: color 0.2s;
        }

        .nav-sidebar a:hover {
            color: #38bdf8;
            /* Light Blue hover */
        }

        .nav-sidebar a.sub-link {
            padding-left: 1rem;
            font-size: 0.9rem;
            color: #cbd5e1;
            /* Slightly muted white */
        }

        .nav-sidebar a.sub-link:hover {
            color: #38bdf8;
        }

        /* ... styles ... */

        /* Main Content */
        .content-area {
            flex: 1;
            padding: 3rem 4rem;
            overflow-y: auto;
            scroll-behavior: smooth;
            order: 2;
            /* Changed from 1 */
            /* Right side */
        }

        h1,
        h2,
        h3,
        h4 {
            color: var(--text-main);
        }

        h1 {
            font-size: 2.25rem;
            margin-bottom: 1rem;
            padding-bottom: 1rem;
            border-bottom: 2px solid var(--border);
        }

        h2 {
            font-size: 1.75rem;
            margin-top: 2.5rem;
            margin-bottom: 1rem;
            color: var(--primary);
        }

        h3 {
            font-size: 1.4rem;
            margin-top: 2rem;
            margin-bottom: 0.75rem;
        }

        h4 {
            font-size: 1.1rem;
            margin-top: 1.5rem;
        }

        p,
        ul {
            margin-bottom: 1rem;
        }

        code {
            background-color: rgba(125, 125, 125, 0.1);
            padding: 0.2rem 0.4rem;
            border-radius: 4px;
            font-family: Consolas, monospace;
        }

        pre {
            background-color: rgba(125, 125, 125, 0.1);
            padding: 1rem;
            border-radius: 8px;
            overflow-x: auto;
        }

        .alert {
            padding: 1rem;
            border-radius: 8px;
            margin: 1.5rem 0;
            border-left: 4px solid;
        }

        .alert-note {
            background-color: rgba(59, 130, 246, 0.1);
            border-color: #3b82f6;
            color: #1e40af;
        }

        @media (prefers-color-scheme: dark) {
            .alert-note {
                color: #93c5fd;
            }
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin: 1.5rem 0;
        }

        th,
        td {
            border: 1px solid var(--border);
            padding: 0.75rem;
            text-align: left;
        }

        th {
            background-color: rgba(125, 125, 125, 0.05);
        }

        img {
            max-width: 100%;
            height: auto;
            border-radius: 8px;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        }
    </style>
</head>

<body>

    <div class="container">
        <main class="content-area">
            <h1 id="top">Documentation Fonctionnelle - Ezio</h1>

            <p><strong>Ezio</strong> est une application web d√©di√©e √† l'audit et au pilotage assist√© par Intelligence
                Artificielle (IA). Elle permet de charger des grilles d'audit, de les remplir, d'analyser les donn√©es et
                de g√©n√©rer des rapports ou des plans d'action gr√¢ce √† l'IA.</p>

            <hr>

            <h2 id="vue-ensemble">1. Vue d'Ensemble & Fonctionnement</h2>
            <p>L'application est structur√©e autour de quatre modules principaux accessibles via la barre de navigation
                sup√©rieure :</p>

            <h3 id="module-audit">1.1 Module Audit (Vue Principale)</h3>
            <p>C'est le c≈ìur de l'application o√π l'utilisateur interagit avec la grille d'audit.</p>
            <ul>
                <li><strong>Affichage</strong> : Les donn√©es sont pr√©sent√©es sous forme de tableau dynamique.</li>
                <li><strong>Navigation</strong> : Une barre lat√©rale (√† gauche) permet de naviguer rapidement entre les
                    <strong>Chapitres</strong> et <strong>Sous-Chapitres</strong> d√©finis dans la grille.
                </li>
                <li><strong>Fonctionnalit√©s Cl√©s</strong> :
                    <ul>
                        <li><strong>Filtrage</strong> : Par chapitre, sous-chapitre ou via la barre de recherche
                            textuelle globale.</li>
                        <li><strong>Tri</strong> : En cliquant sur les en-t√™tes de colonnes.</li>
                        <li><strong>√âdition</strong> : Les cellules peuvent √™tre modifi√©es (texte, listes d√©roulantes,
                            cases √† cocher).</li>
                        <li><strong>Assistant IA</strong> : Certaines colonnes sp√©ciales permettent d'invoquer une IA
                            pour g√©n√©rer du contenu (ex: recommandations, analyses) bas√© sur les autres colonnes de la
                            ligne.</li>
                    </ul>
                </li>
            </ul>
            </li>
            <li><strong>Gestion Dynamique des Lignes</strong> :
                <ul>
                    <li><strong>Duplication (+)</strong> : Chaque ligne poss√®de un bouton "+" permettant de la dupliquer
                        instantan√©ment. La nouvelle ligne appara√Æt juste en dessous.</li>
                    <li><strong>√âdition de Question</strong> : Sur une ligne dupliqu√©e, le texte de la colonne
                        "Question" devient modifiable (champ texte).</li>
                    <li><strong>Suppression (üóëÔ∏è)</strong> : Les lignes ajout√©es manuellement peuvent √™tre supprim√©es
                        via l'ic√¥ne poubelle. (Protection : les lignes d'origine de l'audit ne sont pas supprimables).
                    </li>
                </ul>
            </li>
            </ul>

            <h3 id="module-dashboard">1.2 Module Tableau de Bord</h3>
            <p>Permet la visualisation graphique des donn√©es de l'audit en cours.</p>
            <ul>
                <li><strong>Configuration</strong> : L'utilisateur choisit une colonne √† analyser (ex: "Conformit√©") et
                    un type de graphique (Camembert, Barres, Anneau).</li>
                <li><strong>Widgets</strong> : Les graphiques sont g√©n√©r√©s dynamiquement en comptant les occurrences des
                    valeurs (ex: nombre de "Conforme" vs "Non Conforme").</li>
            </ul>

            <h3 id="module-createur">1.3 Module Formulaires (Cr√©ateur)</h3>
            <p>Un outil pour transformer des donn√©es brutes en une application d'audit structur√©e.</p>
            <ul>
                <li><strong>Import</strong> : Charge un fichier JSON plat ou un CSV converti.</li>
                <li><strong>Configuration</strong> : Permet de d√©finir pour chaque colonne :
                    <ul>
                        <li>Son <strong>Type</strong> (Question, R√©ponse, Liste d√©roulante, IA, etc.).</li>
                        <li>Sa <strong>Visibilit√©</strong>.</li>
                        <li>Ses <strong>Param√®tres</strong> (Options pour les listes, Prompt pour l'IA, couleurs).</li>
                    </ul>
                </li>
                <li><strong>G√©n√©ration</strong> : Produit un fichier JSON structur√© (<code>audit_config.json</code>)
                    pr√™t √† √™tre charg√© dans le module Audit. Ce m√™me fichier servira de support de sauvegarde tout au
                    long de l'audit (en √©crasant la version pr√©c√©dente √† chaque enregistrement).</li>
            </ul>

            <h3 id="module-modeles">1.4 Module Mod√®les (Configuration IA)</h3>
            <p>Ce module permet de g√©rer les connexions aux "Moteurs d'IA" (LLM) utilis√©s par l'application. Pour
                ajouter ou modifier un mod√®le, vous devez renseigner les champs suivants :</p>

            <h4>Champs Informatifs :</h4>
            <ul>
                <li><strong>Nom (Affich√©)</strong> : Le nom qui appara√Ætra dans les listes d√©roulantes de l'application
                    (ex: "GPT-4 Expert").</li>
                <li><strong>Description</strong> : Une note personnelle pour se souvenir de l'usage du mod√®le.</li>
                <li><strong>Prompt Syst√®me</strong> : L'instruction de base qui d√©finit la personnalit√© de l'IA (ex: "Tu
                    es un auditeur certifi√© ISO 27001...").</li>
            </ul>

            <h4>Champs Techniques :</h4>
            <ul>
                <li><strong>Fournisseur (Provider)</strong> :
                    <ul>
                        <li><code>OpenAI</code> : Pour utiliser les mod√®les "cloud" de ChatGPT (n√©cessite une connexion
                            internet et une cl√© payante) ou pour se connecter aux plateformes compatibles (Dragonfly,
                            Cloud Temple).</li>
                        <li><code>LM Studio (Local)</code> : Pour utiliser un mod√®le tournant sur votre propre machine
                            (gratuit, priv√©, hors-ligne). L'adresse par d√©faut est souvent
                            <code>http://localhost:1234/api/v1/chat</code>.
                        </li>
                        <li><code>Mock</code> : Un mode "bouchon" pour tester l'interface sans v√©ritable IA.</li>
                    </ul>
                </li>
                <li><strong>ID du Mod√®le</strong> : L'identifiant technique pr√©cis attendu par l'API (ex:
                    <code>gpt-4-turbo</code>, <code>mistral-7b-instruct</code>).
                    <ul>
                        <li><em>Nouveau :</em> Un bouton <strong>"Tester la connexion"</strong> permet de r√©cup√©rer
                            automatiquement la liste des mod√®les disponibles depuis le fournisseur et de les proposer
                            dans une liste d√©roulante.</li>
                    </ul>
                </li>
                <li><strong>Endpoint API</strong> : L'adresse URL du serveur d'inf√©rence.</li>
                <li><strong>Cl√© API (API Key)</strong> : Le mot de passe pour acc√©der au service (laisser ou mettre
                    "not-needed" pour LM Studio local).</li>
            </ul>

            <h4>Param√®tres Avanc√©s :</h4>
            <ul>
                <li><strong>Temp√©rature (0.0 - 1.0)</strong> : Contr√¥le la "cr√©ativit√©".
                    <ul>
                        <li><code>0.0</code> : Tr√®s strict, d√©terministe (recommand√© pour l'audit).</li>
                        <li><code>0.7</code> : √âquilibr√© (par d√©faut).</li>
                        <li><code>1.0</code> : Tr√®s cr√©atif, risque d'hallucination.</li>
                    </ul>
                </li>
                <li><strong>Contexte (Tokens)</strong> : La m√©moire maximale du mod√®le (ex: 4096, 8192, 32000). Plus ce
                    chiffre est haut, plus l'IA peut traiter de texte en une seule fois.</li>
            </ul>

            <div class="alert alert-note">
                <strong>Note :</strong> Ces configurations sont sauvegard√©es localement dans le fichier
                <code>models.json</code> √† la racine de l'application.
            </div>

            <hr>

            <h2 id="logique-app">2. Logique de l'Application</h2>

            <h3 id="chargement">2.1 Chargement des Donn√©es</h3>
            <p>L'application peut charger des donn√©es de deux mani√®res :</p>
            <ol>
                <li><strong>Templates (Mod√®les de Documents)</strong> : Des grilles pr√©-configur√©es stock√©es dans le
                    dossier <code>/templates</code>. Elles servent de point de d√©part pour de nouveaux audits (ex: ISO
                    42001, RGPD).</li>
                <li><strong>Fichiers Locaux</strong> : Des fichiers <code>.json</code> sauvegard√©s par l'utilisateur
                    contenant un audit en cours ou termin√©.</li>
            </ol>

            <h3 id="structure-colonnes">2.2 Structure et Types de Colonnes</h3>
            <p>Toute la logique de l'audit repose sur sa configuration des colonnes. Chaque colonne poss√®de un
                <strong>Type</strong> qui d√©finit son comportement et ses options :
            </p>

            <ul>
                <li><strong>Structurelles (Navigation)</strong>
                    <ul>
                        <li><code>Chapitre</code> & <code>Sous-Chapitre</code> : Ces colonnes sont en lecture seule.
                            Elles ne servent pas √† la saisie mais construisent automatiquement le <strong>menu de
                                navigation lat√©ral</strong>.</li>
                    </ul>
                </li>
                <li><strong>Informatives (Lecture Seule)</strong>
                    <ul>
                        <li><code>Question</code> & <code>R√©f√©rence</code> : Affichent du texte statique (ex: l'exigence
                            de la norme).
                            <ul>
                                <li><em>Option :</em> <strong>Taille</strong> (S, M, L) pour ajuster la largeur de la
                                    colonne.</li>
                            </ul>
                        </li>
                        <li><code>Popup</code> : Affiche un contenu riche (Markdown) masqu√© par d√©faut sous un badge
                            "Preuves". Au survol ou au clic, le contenu complet appara√Æt. Id√©al pour les descriptions
                            longues (supporte les sauts de ligne, listes √† puces, gras, italique).</li>
                    </ul>
                </li>
                <li><strong>Saisie (Int√©ractions)</strong>
                    <ul>
                        <li><code>R√©ponse</code> : Un champ texte libre (multiligne) pour saisir un constat ou une
                            remarque.</li>
                        <li><code>Combo</code> : Une liste d√©roulante pour un choix unique (ex: Conforme / Non
                            Conforme).
                            <ul>
                                <li><em>Options :</em> Liste des valeurs possibles.</li>
                                <li><em>Couleurs :</em> Possibilit√© d'associer un sch√©ma de couleurs automatique (ex:
                                    Vert/Orange/Rouge) selon la valeur choisie.</li>
                            </ul>
                        </li>
                        <li><code>QCM</code> : Une liste de cases √† cocher pour des choix multiples (ex: Documents
                            manquants).</li>
                    </ul>
                </li>
                <li><strong>Intelligentes (IA)</strong>
                    <ul>
                        <li><code>IA</code> : Une colonne sp√©ciale dot√©e d'un bouton "‚ú®".
                            <ul>
                                <li><em>Comportement :</em> En cliquant, l'IA g√©n√®re du contenu (texte ou checklist)
                                    directement dans la case.</li>
                                <li><em>Configuration :</em> On d√©finit un <strong>Prompt</strong> (l'ordre donn√© √†
                                    l'IA), un <strong>Mod√®le</strong> (le "cerveau" utilis√©) et on s√©lectionne les
                                    <strong>Colonnes Contextuelles</strong> (quelles informations de la ligne l'IA doit
                                    lire pour r√©pondre).
                                </li>
                            </ul>
                        </li>
                    </ul>
                </li>
            </ul>

            <h3 id="logique-ia">2.3 L'Intelligence Artificielle (IA)</h3>
            <p>L'IA n'est pas globale mais <strong>contextuelle √† la ligne</strong>.</p>
            <ul>
                <li>Lorsqu'une colonne est de type <code>IA</code>, elle est configur√©e avec un <strong>Prompt</strong>
                    sp√©cifique (ex: "G√©n√®re une recommandation d'action...").</li>
                <li>Elle peut lire le contenu d'autres colonnes de la <strong>m√™me ligne</strong> (ex: "Description",
                    "Constat", "Preuves") pour g√©n√©rer sa r√©ponse.</li>
                <li>Cela permet une assistance pr√©cise et cibl√©e (ex: analyser une non-conformit√© sp√©cifique).</li>
            </ul>

            <hr>

            <h2 id="installation">3. Installation et Structure Technique</h2>

            <h3 id="install-local">3.1 Installation en Local</h3>

            <h4 id="arborescence">3.1.1 Arborescence des Fichiers</h4>
            <p>L'application est compos√©e de fichiers statiques (HTML, JS, CSS). Voici les √©l√©ments essentiels :</p>

            <table>
                <thead>
                    <tr>
                        <th>Fichier / Dossier</th>
                        <th>Type</th>
                        <th>Description Fonctionnelle</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><code>index.html</code></td>
                        <td>Application</td>
                        <td><strong>Point d'entr√©e principal</strong>. C'est le fichier √† ouvrir dans votre navigateur
                            pour lancer Ezio.</td>
                    </tr>
                    <tr>
                        <td><code>app_*.js</code></td>
                        <td>Scripts</td>
                        <td>Contiennent la logique de chaque module (Audit, Cr√©ateur, Tableau de bord, Mod√®les, Export).
                        </td>
                    </tr>
                    <tr>
                        <td><code>api_ia.js</code></td>
                        <td>API</td>
                        <td>G√®re sp√©cifiquement les connecteurs avec les fournisseurs d'IA (OpenAI, etc.).</td>
                    </tr>
                    <tr>
                        <td><code>style_*.css</code></td>
                        <td>Styles</td>
                        <td>D√©finissent l'apparence visuelle (Th√®mes sombres/clairs, impression).</td>
                    </tr>
                    <tr>
                        <td><code>models.json</code></td>
                        <td>Configuration</td>
                        <td>Stocke vos param√®tres de connexion aux IA (URL, Cl√©s, Prompts).</td>
                    </tr>
                    <tr>
                        <td><code>/templates/</code></td>
                        <td>Dossier</td>
                        <td>Contient les grilles d'audit vierges "pr√™tes √† l'emploi" (ex: <code>ISO42001.json</code>).
                        </td>
                    </tr>
                    <tr>
                        <td><code>/docs/</code></td>
                        <td>Dossier</td>
                        <td>Contient la documentation utilisateur.</td>
                    </tr>
                </tbody>
            </table>

            <h4 id="lancement-local">3.1.2 Lancement (Serveur Web Local)</h4>
            <p>Bien qu'il soit possible d'ouvrir directement <code>index.html</code>, il est <strong>fortement
                    recommand√©</strong> d'utiliser un serveur web local.<br>
                Pourquoi ? Les navigateurs modernes appliquent des r√®gles de s√©curit√© strictes (CORS) qui peuvent
                bloquer le chargement des fichiers JSON (Templates ou Config) si le fichier est ouvert en "file://".</p>

            <p><strong>M√©thode recommand√©e (Simple Web Server) :</strong></p>
            <ol>
                <li>Installez une extension de navigateur comme <strong>"Web Server for Chrome"</strong> ou un
                    utilitaire l√©ger type <strong>"SimpleWebServer"</strong> (Windows).
                    <ul>
                        <li><em>Alternative Python :</em> Ouvrez un terminal dans le dossier et tapez
                            <code>python -m http.server</code>.
                        </li>
                    </ul>
                </li>
                <li>Configurez l'outil pour pointer vers le dossier racine de l'application Ezio.</li>
                <li>Ouvrez l'adresse locale fournie (g√©n√©ralement <code>http://127.0.0.1:8887</code> ou
                    <code>http://localhost:8000</code>).
                </li>
            </ol>

            <h3 id="typologie-fichiers">3.2 Typologie des Fichiers</h3>
            <p>L'application manipule trois types de fichiers JSON distincts.</p>

            <div class="alert alert-note">
                <strong>Modifications Manuelles</strong><br>
                Vous avez la libert√© de cr√©er ou modifier ces fichiers manuellement si vous le souhaitez. Ils
                fonctionneront parfaitement tant que la structure JSON est respect√©e. Cependant, pour plus de
                simplicit√©, l'ensemble de ces op√©rations peut √™tre r√©alis√© directement depuis l'interface de
                l'application.
            </div>

            <h4 id="fichier-audit">3.2.1 Fichier d'Audit / Donn√©es (<code>*.json</code>)</h4>
            <p>C'est le fichier principal qui contient √† la fois la structure de la grille et les donn√©es saisies.</p>
            <p><strong>Structure technique :</strong></p>
            <pre><code>{
  "columns": [
    {
      "id": "ref",
      "label": "R√©f√©rence",
      "type": "question", 
      "visible": true,
      "params": { ... }
    },
    ...
  ],
  "rows": [
    ["1.1", "Politique", "Texte..."],
    ["1.2", "Organisation", "Texte..."]
  ],
  "statics": []
}</code></pre>
            <p>Ce fichier est "autonome" : il contient tout ce qui est n√©cessaire pour afficher et continuer l'audit.
            </p>

            <h4 id="fichiers-templates">3.2.2 Mod√®les de Documents (Templates)</h4>
            <p>Ce sont des fichiers d'Audit (m√™me structure que 3.1) mais "vides" ou "pr√™ts √† l'emploi".</p>
            <ul>
                <li>Ils sont situ√©s dans le dossier <code>/templates/</code>.</li>
                <li>Ils d√©finissent le standard (ex: toutes les exigences d'une norme) mais les colonnes de "R√©ponse" ou
                    "Constat" sont g√©n√©ralement vides.</li>
            </ul>

            <h4 id="config-ia">3.2.3 Configuration des Mod√®les IA (<code>models.json</code>)</h4>
            <p>Ce fichier stocke la liste des connecteurs IA disponibles.</p>
            <p><strong>Emplacement</strong> : Racine de l'application (ou g√©r√© par le navigateur en local).</p>
            <p><strong>Structure :</strong></p>
            <pre><code>[
  {
    "nom": "GPT-4 Expert",
    "provider": "openai",
    "endpoint": "https://api.openai.com/v1/...",
    "apikey": "sk-...",
    "model": "gpt-4",
    "prompt": "Tu es un expert auditeur..."
  }
]</code></pre>
            <p>Ce fichier permet √† l'application de savoir quel "cerveau" utiliser lorsqu'on clique sur le bouton "‚ú®"
                d'une colonne IA.</p>

        </main>

        <nav class="nav-sidebar">
            <h3>Navigation</h3>
            <ul>
                <li><a href="#top">Introduction</a></li>
                <li><a href="#vue-ensemble">1. Vue d'Ensemble</a>
                    <ul>
                        <li><a href="#module-audit" class="sub-link">1.1 Module Audit</a></li>
                        <li><a href="#module-dashboard" class="sub-link">1.2 Tableau de Bord</a></li>
                        <li><a href="#module-createur" class="sub-link">1.3 Cr√©ateur</a></li>
                        <li><a href="#module-modeles" class="sub-link">1.4 Mod√®les IA</a></li>
                    </ul>
                </li>
                <li><a href="#logique-app">2. Logique Application</a>
                    <ul>
                        <li><a href="#chargement" class="sub-link">2.1 Chargement</a></li>
                        <li><a href="#structure-colonnes" class="sub-link">2.2 Colonnes & Types</a></li>
                        <li><a href="#logique-ia" class="sub-link">2.3 IA Contextuelle</a></li>
                    </ul>
                </li>
                <li><a href="#installation">3. Installation</a>
                    <ul>
                        <li><a href="#install-local" class="sub-link">3.1 Installation Local</a></li>
                        <li><a href="#typologie-fichiers" class="sub-link">3.2 Typologie Fichiers</a></li>
                    </ul>
                </li>
            </ul>
        </nav>
    </div>

</body>

</html>